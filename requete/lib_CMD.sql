create table TmpLib (lib varchar(500))
insert into TmpLib values ('33029 A propos de votre société Fichier');
insert into TmpLib values ('4097 identification Fichier');
insert into TmpLib values ('4102 initialisation Fichier');
insert into TmpLib values ('4106 Contacts Fichier');
insert into TmpLib values ('4101 Paramètres comptables Fichier');
insert into TmpLib values ('4098 Paramètres commerciaux Fichier');
insert into TmpLib values ('4107 Communications Fichier');
insert into TmpLib values ('4099 Préférences Fichier');
insert into TmpLib values ('4100 Options Fichier');
insert into TmpLib values ('65408 Liste des modèles de calendrier Fichier');
insert into TmpLib values ('65414 Identification Fichier');
insert into TmpLib values ('65415 Horaires Fichier');
insert into TmpLib values ('33030 Lire les informations Fichier');
insert into TmpLib values ('33038 Configuration système et partage Fichier');
insert into TmpLib values ('34060 Importer au format Sage Fichier');
insert into TmpLib values ('34071 Importer au format paramétrable Fichier');
insert into TmpLib values ('34061 Exporter au format Sage Fichier');
insert into TmpLib values ('34072 Exporter au format paramétrable Fichier');
insert into TmpLib values ('34073 Définier les formats d''import/export paramétrables Fichier');
insert into TmpLib values ('33040 Communication site à site Fichier');
insert into TmpLib values ('33043 Communication planifiée Fichier');
insert into TmpLib values ('33044 Fiche principale Fichier');
insert into TmpLib values ('33045 Données Fichier');
insert into TmpLib values ('33050 Dossier entreprise Fichier');
insert into TmpLib values ('33051 Options Fichier');
insert into TmpLib values ('33052 Agenda Fichier');
insert into TmpLib values ('33053 Champs statistiques tiers Fichier');
insert into TmpLib values ('33054 Champs statistiques articles Fichier');
insert into TmpLib values ('33055 Conditionnement Fichier');
insert into TmpLib values ('33056 Gamme Fichier');
insert into TmpLib values ('33071 Calendrier Fichier');
insert into TmpLib values ('33033 Mise en page Fichier');
insert into TmpLib values ('33034 Format d''impression Fichier');
insert into TmpLib values ('33035 Imprission différée Fichier');
insert into TmpLib values ('33549 Mise à jour des tarifs Fichier');
insert into TmpLib values ('33559 Mise à jour des prévisions Fichier');
insert into TmpLib values ('33578 Mise à jour des références et des codes barres Fichier');
insert into TmpLib values ('33584 Enrichissement des coordonnées bancaires tiers Fichier');
insert into TmpLib values ('33583 Recalcul des informations libres Fichier');
insert into TmpLib values ('4353 Réajustement des cumuls Fichier');
insert into TmpLib values ('33537 Liste des familles Structure');
insert into TmpLib values ('4609 Fiche principale Structure');
insert into TmpLib values ('4611 Complément Structure');
insert into TmpLib values ('4610 Tarification Structure');
insert into TmpLib values ('33538 Liste des articles Structure');
insert into TmpLib values ('4865 Fiche principale Structure');
insert into TmpLib values ('4866 Complément Structure');
insert into TmpLib values ('4867 Descriptif Structure');
insert into TmpLib values ('4868 Information libre Structure');
insert into TmpLib values ('4872 Ressources Structure');
insert into TmpLib values ('4870 Stock Structure');
insert into TmpLib values ('4871 statistiques Structure');
insert into TmpLib values ('33556 Liste des nomenclatures Structure');
insert into TmpLib values ('12288 Composition Structure');
insert into TmpLib values ('12290 Composition /gammes Structure');
insert into TmpLib values ('12289 Gamme opératoire Structure');
insert into TmpLib values ('12291 Gamme opé,/gamme Structure');
insert into TmpLib values ('12292 Prévisions Structure');
insert into TmpLib values ('12293 Prévisions /gammes Structure');
insert into TmpLib values ('34817 Plan comptable Structure');
insert into TmpLib values ('5633 Fiche principale Structure');
insert into TmpLib values ('5637 Analytique Structure');
insert into TmpLib values ('5635 Bloc-note Structure');
insert into TmpLib values ('5636 Information libre Structure');
insert into TmpLib values ('5634 Cumuls Structure');
insert into TmpLib values ('34818 Plan analytique Structure');
insert into TmpLib values ('5889 Fiche principale Structure');
insert into TmpLib values ('5891 Information libre Structure');
insert into TmpLib values ('5890 Cumuls Structure');
insert into TmpLib values ('34819 Liste des taux de taxes Structure');
insert into TmpLib values ('34820 Liste des codes journaux Structure');
insert into TmpLib values ('34821 Liste des banques Structure');
insert into TmpLib values ('10753 Identification Structure');
insert into TmpLib values ('10755 Contacts Structure');
insert into TmpLib values ('10754 R,I,B Structure');
insert into TmpLib values ('34822 Liste des modèles de règlement Structure');
insert into TmpLib values ('34823 Liste des modèles de grille Structure');
insert into TmpLib values ('33550 Liste des codes affaires Structure');
insert into TmpLib values ('11777 Fiche principale Structure');
insert into TmpLib values ('11779 Information libre Structure');
insert into TmpLib values ('11778 statistiques Structure');
insert into TmpLib values ('33541 Liste des clients Structure');
insert into TmpLib values ('5121 Identification Structure');
insert into TmpLib values ('5130 Contacts Structure');
insert into TmpLib values ('5122 Complément Structure');
insert into TmpLib values ('5123 Banques Structure');
insert into TmpLib values ('5131 Modèles Structure');
insert into TmpLib values ('5124 Information libre Structure');
insert into TmpLib values ('5125 Lieux de livraison Structure');
insert into TmpLib values ('5126 Tarification Structure');
insert into TmpLib values ('5127 Abonnements Structure');
insert into TmpLib values ('5128 statistiques Structure');
insert into TmpLib values ('5129 Agenda Structure');
insert into TmpLib values ('33542 Liste des fournisseurs Structure');
insert into TmpLib values ('5377 Identification Structure');
insert into TmpLib values ('5385 Contacts Structure');
insert into TmpLib values ('5378 Complément Structure');
insert into TmpLib values ('5379 Banques Structure');
insert into TmpLib values ('5386 Modèles Structure');
insert into TmpLib values ('5380 Information libre Structure');
insert into TmpLib values ('5381 Tarification Structure');
insert into TmpLib values ('5382 Abonnements Structure');
insert into TmpLib values ('5383 statistiques Structure');
insert into TmpLib values ('5384 Agenda Structure');
insert into TmpLib values ('33544 Liste des commissions représentants Structure');
insert into TmpLib values ('33553 Liste des rabais ,remisee et ristournes clients Structure');
insert into TmpLib values ('33569 Liste des rabais ,remisee et ristournes fournisseurs Structure');
insert into TmpLib values ('33554 Liste des soldes et promotions clients Structure');
insert into TmpLib values ('33570 liste des soldes et promotions fournisseurs Structure');
insert into TmpLib values ('33545 Liste des glossaires Structure');
insert into TmpLib values ('33551 Listes des modèles d''enregistrement Structure');
insert into TmpLib values ('4944 Modèles Structure');
insert into TmpLib values ('4945 Complément Structure');
insert into TmpLib values ('33557 Liste des ressources Structure');
insert into TmpLib values ('4960 Fiche principale Structure');
insert into TmpLib values ('4968 Complément Structure');
insert into TmpLib values ('4961 Centres de charge Structure');
insert into TmpLib values ('4969 Articles rattachés Structure');
insert into TmpLib values ('4976 Capacité Structure');
insert into TmpLib values ('4977 Information libre Structure');
insert into TmpLib values ('4978 Agenda Structure');
insert into TmpLib values ('33558 Centres de charges Structure');
insert into TmpLib values ('4962 Fiche principale Structure');
insert into TmpLib values ('4963 Ressources Structure');
insert into TmpLib values ('4964 Articles rattachés Structure');
insert into TmpLib values ('4965 Capacité Structure');
insert into TmpLib values ('4966 Information libre Structure');
insert into TmpLib values ('4967 Agenda Structure');
insert into TmpLib values ('33546 Liste des collaborateurs Structure');
insert into TmpLib values ('12080 Identification Structure');
insert into TmpLib values ('12081 Profil Structure');
insert into TmpLib values ('12082 Complément Structure');
insert into TmpLib values ('33547 Liste des dépots Structure');
insert into TmpLib values ('12096 Fiche principale Structure');
insert into TmpLib values ('12098 Contacts Structure');
insert into TmpLib values ('12099 Emplacements Structure');
insert into TmpLib values ('34049 Liste des documents de vente Traitement');
insert into TmpLib values ('6145 Devis Traitement');
insert into TmpLib values ('6146 Bon de commande Traitement');
insert into TmpLib values ('6152 Préparation de livraison Traitement');
insert into TmpLib values ('6147 Bon de livraison Traitement');
insert into TmpLib values ('6148 Bon de retour Traitement');
insert into TmpLib values ('6149 Bon d''avoir Traitement');
insert into TmpLib values ('6150 Facture Traitement');
insert into TmpLib values ('6151 Facture comptabilisée Traitement');
insert into TmpLib values ('34050 Liste des documents d''achat Traitement');
insert into TmpLib values ('6401 Préparation de commande Traitement');
insert into TmpLib values ('6402 Bon de commande Traitement');
insert into TmpLib values ('6403 Bon de livraison Traitement');
insert into TmpLib values ('6404 Bon de retour Traitement');
insert into TmpLib values ('6405 Bon d''avoir Traitement');
insert into TmpLib values ('6406 Facture Traitement');
insert into TmpLib values ('6407 Facture comptabilisée Traitement');
insert into TmpLib values ('34051 liste des documents de stock Traitement');
insert into TmpLib values ('8193 Mouvement d''entrée Traitement');
insert into TmpLib values ('8194 Mouvement de sortie Traitement');
insert into TmpLib values ('8195 Dépréciation du stock Traitement');
insert into TmpLib values ('8196 Virement de dépôt Traitement');
insert into TmpLib values ('8197 Préparation de fabrication Traitement');
insert into TmpLib values ('8199 Ordre de fabrication Traitement');
insert into TmpLib values ('8198 Bon de fabrication Traitement');
insert into TmpLib values ('34128 Liste des documents internes Traitement');
insert into TmpLib values ('12305 Document interne 1 Traitement');
insert into TmpLib values ('12306 Document interne 2 Traitement');
insert into TmpLib values ('12307 Document interne 3 Traitement');
insert into TmpLib values ('12308 Document interne 4 Traitement');
insert into TmpLib values ('12309 Document interne 5 Traitement');
insert into TmpLib values ('12310 Document interne 6 Traitement');
insert into TmpLib values ('34130 Liste des documents de fabrication Traitement');
insert into TmpLib values ('34162 Projets de fabrication Traitement');
insert into TmpLib values ('34163 Saisie d''avancement par projet Traitement');
insert into TmpLib values ('34165 Ajout de composants/ressources Traitement');
insert into TmpLib values ('34164 Saisie d''avancement par collaborateur Traitement');
insert into TmpLib values ('34131 Simulation de fabrication Traitement');
insert into TmpLib values ('12602 Nomenclature Traitement');
insert into TmpLib values ('12603 Ressource Traitement');
insert into TmpLib values ('34132 Calcul des besoins Traitement');
insert into TmpLib values ('34133 Intorrogation de compte nomenclature Traitement');
insert into TmpLib values ('12597 Interrogation du stock Traitement');
insert into TmpLib values ('12600 Interrogation de la gamme opératoire Traitement');
insert into TmpLib values ('12601 Interrogation nomenclature Traitement');
insert into TmpLib values ('12598 Interrogation des tarifs Traitement');
insert into TmpLib values ('12599 Interrogation commerciale Traitement');
insert into TmpLib values ('34134 Interrogation cas d''emploi Traitement');
insert into TmpLib values ('34135 Interrogation de charge ressource Traitement');
insert into TmpLib values ('34145 Préparation des livraison clients Traitement');
insert into TmpLib values ('34146 Validation des préparations de livraison Traitement');
insert into TmpLib values ('34053 Livraison commandes clients Traitement');
insert into TmpLib values ('34152 Gestion des réceptions fournisseurs Traitement');
insert into TmpLib values ('34153 Contrôle qualité Traitement');
insert into TmpLib values ('34054 Facturation pèriodique Traitement');
insert into TmpLib values ('34319 Réapprovisionnement Traitement');
insert into TmpLib values ('34320 Envoi des commandes fournisseurs Traitement');
insert into TmpLib values ('34100 Réception des devis confirmés Traitement');
insert into TmpLib values ('34167 Réservation planning Traitement');
insert into TmpLib values ('34168 Affectation des documents au planning Traitement');
insert into TmpLib values ('34169 Consultation planning Traitement');
insert into TmpLib values ('34176 Contrôle planning Traitement');
insert into TmpLib values ('34056 Saisir un règlement client Traitement');
insert into TmpLib values ('30081 Saisir un règlement fournissuer Traitement');
insert into TmpLib values ('12121 Mouvement de caisse Date Protection zone');


SELECT SUBSTRING(trim(lib),0,CHARINDEX(' ',trim(lib))) PROT_Cmd,SUBSTRING(trim(lib),CHARINDEX(' ',trim(lib)),len(trim(lib))) Libelle_Cmd
INTO LIB_CMD
FROM TmpLib

ALTER TABLE LIB_CMD ADD Actif INT
GO

UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '33541'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '33537'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '33538'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '34051'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '34049'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '6150'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '6145'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '34050'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '8193'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '8194'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '34056'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '6147'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '34089'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '6148'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '6149'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '33547'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '33542'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '33546'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '34056'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12116'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12117'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12118'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12125'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12126'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12119'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12129'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12124'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '9985'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '8195'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12136'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '12137'
UPDATE LIB_CMD SET Actif=1 WHERE PROT_Cmd = '4868'
GO

ALTER TABLE LIB_CMD ADD Parent int;
GO
INSERT INTO LIB_CMD VALUES (1111,'Fichier',NULL,-1)
INSERT INTO LIB_CMD VALUES (1112,'Structure',NULL,-1)
INSERT INTO LIB_CMD VALUES (1113,'Traitement',NULL,-1)
INSERT INTO LIB_CMD VALUES (1114,'Etat',NULL,-1)
INSERT INTO LIB_CMD VALUES (1115,'Gestion du risque client',NULL,-1)
INSERT INTO LIB_CMD VALUES (1116,'Protection facture',NULL,-1)
INSERT INTO LIB_CMD VALUES (1117,'Protection des zones',NULL,-1)
INSERT INTO LIB_CMD VALUES (12124,'Saisie reglement Date',1117,1)
GO
INSERT INTO LIB_CMD VALUES (12117,'Date achat Date',1117,1)
INSERT INTO LIB_CMD VALUES (12116,'Date vente Date',1117,1)
INSERT INTO LIB_CMD VALUES (12118,'Date stock Date',1117,1)
GO
UPDATE LIB_CMD SET PARENT=1112
WHERE Libelle_Cmd LIKE '%STRUCTURE%'
  AND PROT_Cmd<>1112

UPDATE LIB_CMD SET PARENT=1111
WHERE Libelle_Cmd LIKE '%FICHIER%'
  AND PROT_Cmd<>1111

UPDATE LIB_CMD SET PARENT=1113
WHERE Libelle_Cmd LIKE '%TRAITEMENT%'
  AND PROT_Cmd<>1113

UPDATE LIB_CMD SET Actif=1
WHERE PROT_Cmd IN (30081,6401) or Libelle_Cmd like '%date%'
GO
INSERT INTO LIB_CMD VALUES (12128,'Modification/Suppression VenteComptoir Traitement',1,1113)
INSERT INTO LIB_CMD VALUES (9985,'Gestion du risque client',1,1115)
GO

ALTER TABLE LIB_CMD ADD TypeFlag INT
GO
update LIB_CMD set TypeFlag = 0;
GO
INSERT INTO LIB_CMD VALUES (12125,'Prix d''achat',1,1117,1)
INSERT INTO LIB_CMD VALUES (12126,'Prix de revient',1,1117,1)
INSERT INTO LIB_CMD VALUES (12136,'Controle de toute les caisses (suppression)',1,1113,1)
INSERT INTO LIB_CMD VALUES (12137,'Affichage des valeurs en caisse (modificaiton)',1,1113,1)
INSERT INTO LIB_CMD VALUES (11009,'Avant impression',1,1116,1)
INSERT INTO LIB_CMD VALUES (11010,'Après impression',1,1116,1)
INSERT INTO LIB_CMD VALUES (11011,'Ticket après impression',1,1116,1)
INSERT INTO LIB_CMD VALUES (34067,'Génération des règlements clients',1,1113,1);
INSERT INTO LIB_CMD VALUES (12129,'Quantité négative',1,1117,1);
INSERT INTO LIB_CMD VALUES (12134,'Modification client',1,1113,1);


GO
update LIB_CMD set TypeFlag = 1 WHERE PROT_Cmd IN ('9985','8195','4868','12129','12125','12126','12136','12137');
UPDATE LIB_CMD SET Actif=1
WHERE Libelle_Cmd LIKE '%RISQUE%'
UPDATE LIB_CMD SET Actif=1, Libelle_Cmd=' Document interne 2 Traitement (Transfert détail)'
WHERE PROT_Cmd=12306
GO

INSERT INTO LIB_CMD VALUES (36678,'Etat préparatoire',1,1114,1);
INSERT INTO LIB_CMD VALUES (36677,'Livre d''inventaire',1,1114,1);
INSERT INTO LIB_CMD VALUES (36672,'Statistique article par article',1,1114,1);
INSERT INTO LIB_CMD VALUES (36673,'Statistique article par famille d''article',1,1114,1);
INSERT INTO LIB_CMD VALUES (36674,'Statistique article palmares de vente d''article',1,1114,1);
INSERT INTO LIB_CMD VALUES (34316,'Mouvement de stock',1,1114,1);
INSERT INTO LIB_CMD VALUES (36645,'Statistique client par famille d''article',1,1114,1);
INSERT INTO LIB_CMD VALUES (36646,'Statistique client par article',1,1114,1);
INSERT INTO LIB_CMD VALUES (36647,'Palmares des clients',1,1114,1);
INSERT INTO LIB_CMD VALUES (36661,'Statistique fournisseurs par famille d''article',1,1114,1);
INSERT INTO LIB_CMD VALUES (36662,'Statistique fournisseurs',1,1114,1);
GO
UPDATE P_TIERS SET T_Lg=17, T_Racine=41 WHERE T_Val01T_Intitule='Cl.'
UPDATE P_TIERS SET T_Lg=17, T_Racine=40 WHERE T_Val01T_Intitule='Fr.'
UPDATE P_TIERS SET T_Lg=17, T_Racine=42 WHERE T_Val01T_Intitule='Sal.'
GO

INSERT INTO LIB_CMD VALUES (12133,'Génération écart de règlement',1,1113,1);
INSERT INTO LIB_CMD VALUES (36736,'Statistique de caisse par article',1,1114,1);
INSERT INTO LIB_CMD VALUES (36737,'Statistique de caisse par famille d''article',1,1114,1);
INSERT INTO LIB_CMD VALUES (36738,'Statistique de caisse par mode de règlements',1,1114,1);
GO

INSERT INTO Z_TypeEnvoiMail VALUES ('Suppression mouvement de caisse')
INSERT INTO Z_TypeEnvoiMail VALUES ('Modification mouvement de caisse')

GO

INSERT INTO LIB_CMD VALUES (36356,'traite en continue (Relevé compte client)',1,1114,1);
INSERT INTO LIB_CMD VALUES (36688,'Statistique collaborateurs par tiers',1,1114,1);
INSERT INTO LIB_CMD VALUES (36689,'Statistique collaborateurs par article',1,1114,1);
INSERT INTO LIB_CMD VALUES (36690,'Statistique collaborateurs par famille',1,1114,1);
INSERT INTO LIB_CMD VALUES (36661,'Statistique fournisseur par famille',1,1114,1);
INSERT INTO LIB_CMD VALUES (36662,'Statistique fournisseur par articles',1,1114,1);
INSERT INTO LIB_CMD VALUES (34306,'cadencier fournisseur (Statistique des achats analytique)',1,1114,1);

INSERT INTO LIB_CMD VALUES (36357,'Relevés d''écheances clients',1,1114,1);
INSERT INTO LIB_CMD VALUES (36358,'Relevés d''écheances fournisseurs',1,1114,1);

INSERT INTO LIB_CMD VALUES (34562,'Vente comptoir',1,1113,0);

INSERT INTO LIB_CMD VALUES (12130,'Saisie prix de vente et remise',1,1113,1);
INSERT INTO LIB_CMD VALUES (12130,'Saisie prix de vente et remise',1,1113,1);
INSERT INTO LIB_CMD VALUES (5126,'Tarification client',1,1112,0);

INSERT INTO LIB_CMD VALUES (33068,'Evenement intéressé(Protection cbCreateur)',1,1117,1);





